<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D·ªäCH V·ª§ SAYGEX PRO MAX</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        /* GI·ªÆ NGUY√äN CSS C≈® C·ª¶A B·∫†N */
        :root { --primary: #ff4757; --gold: #ffa502; --dark: #2f3542; --glass: rgba(255, 255, 255, 0.08); --border: rgba(255, 255, 255, 0.2); }
        body { font-family: 'Montserrat', sans-serif; margin: 0; padding: 20px; color: white; background: linear-gradient(-45deg, #1e272e, #2c3e50, #000000, #130f40); background-size: 400% 400%; animation: gradientBG 15s ease infinite; padding-bottom: 100px; }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        header { text-align: center; margin-bottom: 50px; text-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        .logo { font-size: 3.8rem; font-weight: 900; letter-spacing: 3px; margin: 0; text-transform: uppercase; background: -webkit-linear-gradient(white, #dfe4ea); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 30px; max-width: 1200px; margin: 0 auto; }
        .card { background: var(--glass); border: 1px solid var(--border); border-radius: 25px; overflow: hidden; backdrop-filter: blur(15px); transition: 0.4s; text-align: center; box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37); }
        .card:hover { transform: translateY(-10px); border-color: var(--gold); }
        .card-name { padding: 25px; font-size: 2rem; font-weight: 900; text-transform: uppercase; color: white; }
        .card-price { padding: 20px 0 30px; font-size: 3.5rem; font-weight: 900; }
        
        .basic .card-name { background: linear-gradient(90deg, #ff4757, #ff6b81); }
        .vip .card-name { background: linear-gradient(90deg, #ffa502, #eccc68); }
        .premium .card-name { background: linear-gradient(90deg, #3742fa, #1e90ff); }
        .ultimate .card-name { background: linear-gradient(90deg, #5352ed, #a29bfe); }

        .btn-buy { width: 80%; padding: 18px; margin-bottom: 30px; border-radius: 50px; border: none; font-weight: 900; cursor: pointer; background: white; color: var(--dark); font-size: 1.1rem; transition: 0.3s; }
        .btn-buy:hover { transform: scale(1.05); }

        .party-box { max-width: 1200px; margin: 40px auto; background: #d63031; border-radius: 20px; padding: 30px; position: relative; border: 1px solid rgba(255,255,255,0.2); }
        .party-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .party-item { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; font-size: 0.95rem; }

        /* KHU V·ª∞C TH·ªêNG K√ä (ƒê√£ t·ªëi ∆∞u hi·ªÉn th·ªã) */
        .admin-section { max-width: 1200px; margin: 40px auto; background: rgba(0,0,0,0.5); padding: 25px; border-radius: 20px; border: 1px solid var(--border); }
        .admin-table { width: 100%; border-collapse: collapse; margin-top: 20px; color: white; font-size: 0.9rem; }
        .admin-table th, .admin-table td { padding: 12px; border: 1px solid rgba(255,255,255,0.1); text-align: left; }
        .admin-table th { background: rgba(255,255,255,0.2); }

        /* MODAL */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; color: #2d3436; width: 90%; max-width: 500px; border-radius: 25px; padding: 30px; position: relative; animation: popUp 0.3s ease; }
        @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        input, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 10px; box-sizing: border-box; }
        .time-guide { background: #e3f2fd; color: #0d47a1; padding: 12px; border-radius: 10px; margin-bottom: 15px; font-size: 0.9rem; }
        
        .btn-confirm { width: 100%; padding: 15px; background: #2d3436; color: white; border: none; border-radius: 10px; font-weight: 900; cursor: pointer; margin-top: 15px; font-size: 1.1rem; }
        .btn-confirm:active { transform: scale(0.98); }
    </style>
</head>
<body>

    <header>
        <h1 class="logo">D·ªäCH V·ª§ SAYGEX</h1>
        <div style="color: #bdc3c7; font-weight: 600; letter-spacing: 2px;">PRO MAX EDITION</div>
    </header>

    <div class="grid-container">
        <div class="card basic"><div class="card-name">BASIC</div><div class="card-price">199K</div><button class="btn-buy" onclick="openBooking('BASIC', 199)">CH·ªåN G√ìI</button></div>
        <div class="card vip"><div class="card-name">VIP</div><div class="card-price">299K</div><button class="btn-buy" onclick="openBooking('VIP', 299)">CH·ªåN G√ìI</button></div>
        <div class="card premium"><div class="card-name">PREMIUM</div><div class="card-price">399K</div><button class="btn-buy" onclick="openBooking('PREMIUM', 399)">CH·ªåN G√ìI</button></div>
        <div class="card ultimate"><div class="card-name">ULTIMATE</div><div class="card-price">499K</div><button class="btn-buy" onclick="openBooking('ULTIMATE', 499)">CH·ªåN G√ìI</button></div>
    </div>

    <div class="party-box">
        <h2 style="margin:0; text-transform:uppercase; text-align:center">‚ú® Ti·ªác Saygex ƒê·∫≥ng C·∫•p</h2>
        <div class="party-grid">
            <div class="party-item">üß• <b>B·∫ÆT BU·ªòC:</b> M·∫∑c √°o th√†nh vi√™n.</div>
            <div class="party-item">üçó <b>FREE:</b> Buffet & ƒê·ªì u·ªëng.</div>
            <div class="party-item">‚öîÔ∏è <b>GAME:</b> Minigame c√≥ th∆∞·ªüng.</div>
            <div class="party-item">üéÅ <b>SALE:</b> Gi·∫£m 50% Th·ª© 7.</div>
        </div>
    </div>

    <div class="admin-section">
        <h3 style="margin:0; border-bottom:1px solid rgba(255,255,255,0.3); padding-bottom:10px">
            üìä L·ªäCH S·ª¨ ƒê·∫∂T ƒê∆†N (L∆∞u tr√™n m√°y n√†y)
        </h3>
        <div style="overflow-x:auto; max-height: 300px; overflow-y: auto;">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>T√™n Kh√°ch</th>
                        <th>G√≥i D·ªãch V·ª•</th>
                        <th>Th·ªùi Gian H·∫πn</th>
                        <th>T·ªïng Ti·ªÅn</th>
                        <th>Ng√†y ƒê·∫∑t</th>
                    </tr>
                </thead>
                <tbody id="statsBody">
                    <tr><td colspan="5" style="text-align:center">Ch∆∞a c√≥ d·ªØ li·ªáu...</td></tr>
                </tbody>
            </table>
        </div>
        <button onclick="clearHistory()" style="margin-top:15px; background:#e74c3c; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold">X√ìA L·ªäCH S·ª¨</button>
    </div>

    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span onclick="closeModal()" style="position:absolute; top:15px; right:20px; font-size:1.5rem; cursor:pointer; color:#7f8c8d">&times;</span>
            
            <div id="step1">
                <h2 style="margin-top:0">ƒê·∫∂T G√ìI <span id="pkgName" style="color:#d63031"></span></h2>
                <div class="time-guide">‚è∞ Ho·∫°t ƒë·ªông: 08:00 - 23:00 h√†ng ng√†y.</div>
                
                <input type="text" id="inpName" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n..." required>
                <div style="display:flex; gap:10px">
                    <input type="date" id="inpDate">
                    <input type="time" id="inpTime">
                </div>
                
                <label style="font-weight:bold; display:block; margin-top:10px">Ch·ªçn nh√¢n vi√™n:</label>
                <select id="inpStaff">
                    <option value="100">ƒê·∫±ng (+100k)</option>
                    <option value="75">Khang (+75k)</option>
                    <option value="50">Ki√™n (+50k)</option>
                    <option value="0" selected>Tu·∫•n (+0k)</option>
                </select>

                <button class="btn-confirm" onclick="calcInvoice()">TI·∫æP T·ª§C ‚ûù</button>
            </div>

            <div id="step2" style="display:none">
                <h2 style="margin-top:0; text-align:center">H√ìA ƒê∆†N</h2>
                <div style="background:#f8f9fa; padding:15px; border-radius:15px; border:1px dashed #bdc3c7" id="invoiceDetails">
                    </div>
                <button class="btn-confirm" onclick="processOrder()">X√ÅC NH·∫¨N & COPY ‚úÖ</button>
                <button onclick="backToStep1()" style="width:100%; border:none; background:none; padding:10px; cursor:pointer; color:#7f8c8d; text-decoration:underline">Quay l·∫°i s·ª≠a</button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. KH·ªûI T·∫†O D·ªÆ LI·ªÜU ---
        // S·ª≠ d·ª•ng m·ªôt t√™n kh√≥a (Key) duy nh·∫•t ƒë·ªÉ tr√°nh tr√πng l·∫∑p
        const STORAGE_KEY = 'saygex_history_v2'; 
        let currentPkg = "", basePrice = 0;
        let orderHistory = [];

        // H√†m n·∫°p d·ªØ li·ªáu ngay khi ch·∫°y web
        function initApp() {
            try {
                const data = localStorage.getItem(STORAGE_KEY);
                if (data) {
                    orderHistory = JSON.parse(data);
                }
            } catch (e) {
                console.error("L·ªói ƒë·ªçc d·ªØ li·ªáu:", e);
                orderHistory = [];
            }
            renderStats(); // V·∫Ω b·∫£ng ngay l·∫≠p t·ª©c
        }

        // --- 2. C√ÅC H√ÄM X·ª¨ L√ù GIAO DI·ªÜN ---
        function openBooking(name, price) {
            currentPkg = name; 
            basePrice = price;
            document.getElementById('pkgName').innerText = name;
            backToStep1(); // Reset v·ªÅ b∆∞·ªõc 1
            document.getElementById('bookingModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('bookingModal').style.display = 'none';
        }

        function backToStep1() {
            document.getElementById('step1').style.display = 'block';
            document.getElementById('step2').style.display = 'none';
        }

        function calcInvoice() {
            const name = document.getElementById('inpName').value.trim();
            const date = document.getElementById('inpDate').value;
            const time = document.getElementById('inpTime').value;
            const staffOpt = document.getElementById('inpStaff');
            const staffFee = parseInt(staffOpt.value);
            const staffName = staffOpt.options[staffOpt.selectedIndex].text;

            if (!name || !date || !time) {
                alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß T√™n, Ng√†y v√† Gi·ªù!");
                return;
            }

            // T√≠nh ti·ªÅn & ∆Øu ƒë√£i
            let total = basePrice + staffFee;
            let note = "";
            const dayOfWeek = new Date(date).getDay();
            if (dayOfWeek === 6) { // Th·ª© 7
                total = total * 0.5;
                note = `<p style="color:red; font-weight:bold">üéâ Gi·∫£m 50% (Th·ª© 7)</p>`;
            }

            // Hi·ªÉn th·ªã h√≥a ƒë∆°n t·∫°m
            document.getElementById('invoiceDetails').innerHTML = `
                <p><b>Kh√°ch:</b> ${name}</p>
                <p><b>G√≥i:</b> ${currentPkg} (${basePrice}k)</p>
                <p><b>Nh√¢n vi√™n:</b> ${staffName}</p>
                <p><b>Th·ªùi gian:</b> ${time} - ${date}</p>
                ${note}
                <hr>
                <h3 style="color:#d63031; text-align:center; margin-bottom:0">T·ªîNG: ${total}K</h3>
            `;

            // L∆∞u t·∫°m bi·∫øn to√†n c·ª•c ƒë·ªÉ b∆∞·ªõc sau d√πng
            window.tempOrderData = {
                name: name,
                pkg: currentPkg,
                time: time + " " + date,
                total: total + "K",
                staff: staffName,
                timestamp: new Date().toLocaleString()
            };

            document.getElementById('step1').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
        }

        // --- 3. X·ª¨ L√ù "L∆ØU D·ªÆ LI·ªÜU" V√Ä "COPY" ---
        function processOrder() {
            const order = window.tempOrderData;
            
            // A. L∆ØU V√ÄO LOCAL STORAGE (Kh√¥ng b·ªã m·∫•t khi reload)
            orderHistory.push(order);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(orderHistory));
            
            // B. C·∫¨P NH·∫¨T B·∫¢NG NGAY
            renderStats();

            // C. TH·ª∞C HI·ªÜN COPY (Ph∆∞∆°ng ph√°p "Textarea ·∫£o" m·∫°nh nh·∫•t)
            const textToCopy = `üîî ƒê∆†N H√ÄNG SAYGEX M·ªöI:\nüë§ Kh√°ch: ${order.name}\nüì¶ G√≥i: ${order.pkg}\nüõ† NV: ${order.staff}\n‚è∞ H·∫πn: ${order.time}\nüí∞ T·ªîNG: ${order.total}`;
            
            const textArea = document.createElement("textarea");
            textArea.value = textToCopy;
            textArea.style.position = "fixed"; // Tr√°nh cu·ªôn trang
            textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                // Hi·ªáu ·ª©ng ƒÉn m·ª´ng
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                alert("‚úÖ ƒê√£ l∆∞u ƒë∆°n & Copy n·ªôi dung!\n·∫§n OK ƒë·ªÉ chuy·ªÉn sang Facebook d√°n tin nh·∫Øn.");
            } catch (err) {
                alert("L·ªói copy t·ª± ƒë·ªông. Vui l√≤ng ch·ª•p m√†n h√¨nh!");
            }
            document.body.removeChild(textArea);

            // D. CHUY·ªÇN H∆Ø·ªöNG FACEBOOK
            closeModal();
            setTimeout(() => {
                window.open("https://www.facebook.com/nguyen.duc.kien.30082", "_blank");
            }, 500);
        }

        // --- 4. V·∫º B·∫¢NG TH·ªêNG K√ä ---
        function renderStats() {
            const tbody = document.getElementById('statsBody');
            if (orderHistory.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:20px; color:#bbb">Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o ƒë∆∞·ª£c l∆∞u.</td></tr>';
                return;
            }

            // ƒê·∫£o ng∆∞·ª£c m·∫£ng ƒë·ªÉ ƒë∆°n m·ªõi nh·∫•t l√™n ƒë·∫ßu
            // D√πng map ƒë·ªÉ t·∫°o HTML string nhanh g·ªçn
            let html = orderHistory.slice().reverse().map(item => `
                <tr>
                    <td><b>${item.name}</b></td>
                    <td>${item.pkg}</td>
                    <td>${item.time}</td>
                    <td style="color:#f1c40f; font-weight:bold">${item.total}</td>
                    <td style="font-size:0.8rem; color:#bdc3c7">${item.timestamp}</td>
                </tr>
            `).join('');

            tbody.innerHTML = html;
        }

        function clearHistory() {
            if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a to√†n b·ªô l·ªãch s·ª≠ ƒë∆°n h√†ng tr√™n m√°y n√†y?")) {
                orderHistory = [];
                localStorage.removeItem(STORAGE_KEY);
                renderStats();
            }
        }

        // CH·∫†Y H√ÄM KH·ªûI T·∫†O
        initApp();

    </script>
</body>
</html>
